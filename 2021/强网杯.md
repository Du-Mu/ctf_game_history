## 比赛信息

> 比赛名称：第五届“强网杯”全国网络安全挑战赛（线上赛）
>
> 比赛网址：https://ctf.ichunqiu.com/2021qwb
>
> 比赛时间：2021年06月12日 09:00~2021年06月13日 21:00

<br/>

## writeup

[强网杯2021 Writeup —— CSA萌新划水队](https://mp.weixin.qq.com/s/ItaIgLxcXCjvAhyyP3On9Q)

[强网杯[pop_master]与[陀那多]赛题的出题记录](https://www.anquanke.com/post/id/244153)

[强网杯2021 线上赛 HarderXSS 赛题源码](https://github.com/crystalrays/qwb2021-harderxss)

[2021 强网杯Wirte Up-白帽子社区](https://mp.weixin.qq.com/s/or5gKC3aNqGAj0YQbC5gSg)

[qwb2021 第五届强网杯线上赛区块链](https://hitcxy.com/2021/qwb2021/)

[第五届强网杯全国网络安全挑战赛WEB-部分writeup-强网杯2021](https://rce.moe/2021/06/14/QWB-2021-WEB-WP)

[强网杯 Write-Up By W&M（RE部分）](https://mp.weixin.qq.com/s/01xX0er1a4-E8vLRce32mg)

[强网杯 Write-Up By W&M（CRYPTO和MISC部分）](https://mp.weixin.qq.com/s/cDlP29Dx-6Uk5I7mnDFJXQ)

[强网杯 Write-Up By W&M（PWN部分）](https://mp.weixin.qq.com/s/WFF5Fp7xjwFuW3X-4V8rYw)

[强网杯 Write-Up By W&M（WEB部分）](https://mp.weixin.qq.com/s/wsMHazX_DJEF3RXd9cXRWw)

网盘文档：

[2021-强网杯-WP-Nu1L.pdf](../writeup/2021-强网杯-WP-Nu1L.pdf)

[2021-强网杯-Syclover.pdf](../writeup/2021-强网杯-Syclover.pdf)

<br/>

## 附件连接

链接：https://pan.baidu.com/s/1cIT32nYP0TO2e5Gm4ugh8Q 提取码：xing

链接：https://pan.xunlei.com/s/VMdvCj3XBBdH7cLHv18Mjj9GA1 提取码：difa

链接：https://ctf.lanzoui.com/b02c7tkne 密码:xing

<br/>

## 题目信息

### Misc

#### BlueTeaming(188s,49p)

> Powershell scripts were executed by malicious programs. What is the registry key that contained the power shellscript content?（本题flag为非正式形式）
>
> 压缩包解压密码：fantasicqwb2021

附件下载：BlueTeaming.7z（836M）

<br/>

#### ISO1995(113s,76p)

> We follow ISO1995. ISO1995 has many problems though. One known problem is a time.
>
> 压缩包解压密码：fantasicqwb2021

附件下载：ISO1995.7z

<br/>

#### 签到(1364s,8p)

```
flag{welcome_to_qwb_s5}
```

<br/>

#### CipherMan(230s,41p)

> The attacker maliciously accessed the user's PC and encrypted specific volumes. How to decrypt the volume?（本题flag为非正式形式）
>
> 压缩包解压密码：fantasicqwb2021

附件下载：CipherMan.7z（657M）

<br/>

#### ExtremelySlow(60s,127p)

> 压缩包解压密码：fantasicqwb2021

附件下载：ExtremelySlow.7z

<br/>

#### ThreeBody(1s,500p)

> 三体人要入侵地球了，听说他们要使出最厉害的武器……
>
> 压缩包解压密码：fantasicqwb2021
>
> hint:
>
> 1. 不要埋头做，根据已有信息合理使用搜索引擎
>
> 2. 所有出现图片的内容都是有意义的

附件下载：ThreeBody.7z

<br/>

#### 问卷题(419s,23p)

> https://www.wjx.top/vj/PXgE3rj.aspx

```
flag{Welc0me_tO_qwbS5_Hope_you_play_h4ppily}
```

<br/>

#### [强网先锋]协议(0s,500p)

> 压缩包解压密码：fantasicqwb2021
>
> hint:
>
> 1. 纯数字密码
>
> 2. 多看看RFC2759、RFC3079文档 

附件下载：[强网先锋]协议.7z

<br/>

#### EzTime(155s,58p)

> Forensic.Find a file that a time attribute has been modified by a program. （本题flag为非正式形式）
>
> 压缩包解压密码：fantasicqwb2021

附件下载：EzTime.7z

<br/>

### Crypto

#### BabyAEG(9s,358p)

> Try AEG? nc 8.140.174.230 10001
>
> 压缩包解压密码：fantasicqwb2021

附件下载：BabyAEG.7z

<br/>

#### fan(0s,500p)

> nc 47.94.197.238 12312
>
> 新的附件（只添加了pow过程）： [附件下载](https://pan.baidu.com/s/16ADZJCtGNrt47u_BSA7s3g) 提取码（GAME）[备用下载](https://share.weiyun.com/DacexIMM)
>
> hint: 
>
> 1. EdDSA wNAF
>
> 2. 论文：A Tale of Three Signatures，建议尝试一下 g6k。

附件下载：fan.zip

<br/>

#### guess_game(31s,200p)

> Change is better. nc 39.105.139.103 10002
>
> 压缩包解压密码：fantasicqwb2021

附件下载：guess_game.7z

<br/>

#### OneGadget(6s,400p)

> Do you know OneGadget? Your goal is to make solved=true 题目地址为 nc 8.140.108.222 10001
>
> 压缩包解压密码：fantasicqwb2021

附件下载：OneGadget.7z

<br/>

### PWN

#### baby_diary(69s,114p)

> nc 8.140.114.72 1399
>
> 压缩包解压密码：fantasicqwb2021

附件下载：baby_diary.7z

<br/>

#### EzQtest(2s,477p)

> Easy Qtest, pwn EzCloud to get the entry to it. nc 47.94.234.66 37128
>
> 压缩包解压密码：fantasicqwb2021

附件下载：EzQtest.7z

<br/>

#### EzCloud(15s,295p)

> Easy HTTP Server, pwn it to get the entry to EzQtest. nc 47.94.234.66 37128
>
> 压缩包解压密码：fantasicqwb2021

附件下载：EzCloud.7z

<br/>

#### notebook(12s,323p)

> Metaphysics kernel notebook. nc 47.94.200.88 23333
>
> 压缩包解压密码：fantasicqwb2021

附件下载：notebook.7z

<br/>

#### easyheap(2s,477p)

> nc 39.105.135.79 48866
>
> 压缩包解压密码：fantasicqwb2021

附件下载：easyheap.7z

<br/>

#### dhd(2s,477p)

> nc 39.105.138.73 17232
>
> 压缩包解压密码：fantasicqwb2021

附件下载：dhd.7z

<br/>

#### easywarm(5s,417p)

> nc 39.105.134.183 18866
>
> 压缩包解压密码：fantasicqwb2021

附件下载：easywarm.7z

<br/>

#### [强网先锋]orw(183s,50p)

> nc 39.105.131.68 12354
>
> 压缩包解压密码：fantasicqwb2021

附件下载：[强网先锋]orw.7z

<br/>

#### [强网先锋]no_output(144s,62p)

> nc 39.105.138.97 1234
>
> 压缩包解压密码：fantasicqwb2021

附件下载：[强网先锋]no_output.7z

<br/>

#### babypwn(66s,118p)

> have fun! nc 39.105.130.158 8888
>
> 压缩包解压密码：fantasicqwb2021

附件下载：babypwn.zip

<br/>

#### pipeline(54s,137p)

> nc 59.110.173.239 2399
>
> 压缩包解压密码：fantasicqwb2021

附件下载：pipeline.7z

<br/>

#### [强网先锋]shellcode(94s,89p)

> nc 39.105.137.118 50050
>
> 压缩包解压密码：fantasicqwb2021

附件下载：[强网先锋]shellcode.7z

<br/>

#### Fifty-Fifty(1s,500p)

> 找到漏洞和写出漏洞利用是两个相对独立的步骤，这两个步骤花费的时间通常是五五开的。
>
> nc 8.140.186.193 1338
>
> 压缩包解压密码：fantasicqwb2021

附件下载：Fifty-Fifty.7z

~~~python
# 相关文件代码
```python
while size_max > len(code):
    new = raw_input(""code> "")
    if new == ""EOF"":
        finished = True
        break
    code += new + ""\n""
if not finished:
    print(""max length exceeded"")
    sys.exit(42)
file_name = ""/tmp/%s"" % (randstr())
with open(file_name, ""w+"") as f:
    f.write(code.encode())
cmd = ""/home/ctf/jerry ./%s"" % file_name
os.system(cmd)
os.remove(file_name)
```
~~~

<br/>

### Reverse

#### ezmath(168s,54p)

> 压缩包解压密码：fantasicqwb2021

附件下载：ezmath.7z

<br/>

#### unicorn_like_a_pro(13s,313p)

> 压缩包解压密码：fantasicqwb2021

附件下载：unicorn_like_a_pro.7z

<br/>

#### AllInOne(6s,400p)

> 压缩包解压密码：fantasicqwb2021

附件下载：AllInOne.apk.1.1.1.zip

<br/>

#### StandOnTheGiants(62s,124p)

> 压缩包解压密码：fantasicqwb2021

附件下载：StandOnTheGiants.7z

<br/>

#### LongTimeAgo(44s,159p)

> 压缩包解压密码：fantasicqwb2021

附件下载：LongTimeAgo.7z

<br/>

### Web

#### Hard_Penetration(80s,102p)

> 题目内容：渗透测试主要以获取权限为主，这一次，你能获取到什么权限呢。



<br/>

#### pop_master(188s,49p)

> 题目内容：听说你是pop链构建大师？

源码下载：pop_master.zip（动态生成）

<br/>

#### HarderXSS(4s,435p)

> 题目内容：小明在扫描某内网映射服务时发现有人映射了这么个站点在公网上，他发现可以进入对方的内网，你知道小明是怎么做的吗？（内网站点只能https访问。）
>
> hint:
>
> 1. 注意cookie的domain
> 2. 管理中心很关键，有没有什么办法访问（读取）到呢？



<br/>

#### WhereIsUWebShell(44s,159p)

> 题目内容：WhereIsUWebShell

```php
<!-- You may need to know what is in e2a7106f1cc8bb1e1318df70aa0a3540.php-->
<?php
// index.php
ini_set('display_errors', 'on');
if(!isset($_COOKIE['ctfer'])){
    setcookie("ctfer",serialize("ctfer"),time()+3600);
}else{
    include "function.php";
    echo "I see your Cookie<br>";
    $res = unserialize($_COOKIE['ctfer']);
    if(preg_match('/myclass/i',serialize($res))){
        
        throw new Exception("Error: Class 'myclass' not found ");
    }
}
highlight_file(__FILE__);
echo "<br>";
highlight_file("myclass.php");
echo "<br>";
highlight_file("function.php");
<?php
// myclass.php
class Hello{
    public function __destruct()
    {   if($this->qwb) echo file_get_contents($this->qwb);
    }
}
?>
<?php
// function.php
function __autoload($classname){
    require_once "/var/www/html/$classname.php";
}
?>
```

<br/>

#### EasySQL(10s,345p)

> 题目内容：EasySQL
>
> hint: 所有字段都是 varchar 类型

源码下载：EasySQL.zip

<br/>

#### [强网先锋]赌徒(499s,20p)

> 题目内容：[强网先锋]赌徒

源码下载：[强网先锋]赌徒.zip

<br/>

#### Hard_APT_jeesite(8s,371p)

> During the APT, information acquisition is the main focus, The target website has built a jeesite framework, the location is /jeesite/, and the administrator has saved some important email information in the key configuration file of shiro, please find it and get the "flag mail" in the target mailbox.
>
> 47.104.145.168:30025
>
> hint: 题目的邮箱获取如果有问题，请联系客服。



<br/>

#### [强网先锋]寻宝(304s,31p)

> 题目内容：[强网先锋]寻宝

静态文件：[强网先锋]寻宝.zip（119M）

<br/>

#### EasyWeb(132s,67p)

> 题目来源于某次帮朋友测试项目的渗透过程，非常非常简单，没有新的知识点，已经去掉了很多需要脑洞猜测的部分，不过依然需要进行一些信息收集工作。So~ Be Patient~And have funny! ^_^
>
> 47.104.136.46
>
> 47.104.137.239
>
> 121.42.242.238
>
> （每 20 分钟重启一次环境）
>
> hint:
>
> 1. 能看到报错信息是预期现象
> 2. flag不在数据库；

部分文件：EasyWeb.zip

<br/>

#### EasyXSS(18s,271p)

> The BOT starts every five seconds and handles only one reported URL at a time. The BOT is Google-Chrome 91.0.4472.77 (Official Build) (64-bit)
>
> Notice: the address requested by the BOT is http://localhost:8888.
>
> Each time the BOT processes a request, it clears subsequent report URLs from the database
>
> 每 15 分钟重启环境
>
> 47.104.192.54:8888
>
> 47.104.210.56:8888
>
> 47.104.155.242:8888
>
> hint: flag格式是flag{uuid}



<br/>

#### 陀那多(2s,477p)

> 题目内容：守护全世界最好的陀那多
>
> hint: 
>
> 1. pyc
> 2. 注入点在register，需要先获取表名与列名

静态文件：陀那多.zip

<br/>

#### fire_in_the_hole(0s,500p)

> http://60.205.220.11:9090

Openfire Administration Console

