## 比赛信息

> 比赛名称：2021年工业信息安全技能大赛线上赛
>
> 比赛形式：团队赛，最终成绩取参加场次的平均分
>
> 比赛网址：https://icsc.nisia.org.cn/competition
>
> 比赛时间：
>
> 第一场	2020年6月28日 10:00-16:00
> 第二场	2020年7月01日 10:00-16:00
> 第三场	2020年7月04日 10:00-16:15（延迟15分）

<br/>

## writeup

[2021年工业信息安全技能大赛-线上第一场WriteUp](https://mp.weixin.qq.com/s/DFJaILmNxTl1EAyksqQZ9w)

[CTF-2021 年工业信息安全技能大赛线第三场](https://mp.weixin.qq.com/s/FgDw_jHIjTy-xi3UsX51pw)

[2021年工业信息安全技能大赛-线下赛WriteUp（标题有误）](https://mp.weixin.qq.com/s/KX-vLk9QcVc59GjnfcHKwg)

<br/>

## 题目链接

链接：https://pan.baidu.com/s/1dx9KN5fikufsp8fiWZXGrw 提取码：xing

链接：https://pan.xunlei.com/s/VMdqNNbFDNeuK4NeTJZYPO3SA1 提取码：wat7

链接：https://ctf.lanzoui.com/b02c7tbna 密码:xing

<br/>

## 题目信息

### 第一场

#### 简单的梯形图

> 自动化专家老刘给刚刚实习的小王出了一道梯形图计算题：在进行模拟量程序整定时发现程序中整定出的两个数值与实际的相差过大，已知IW2值为12658，V7为64904.41016，V8为1.414213538，需要小王计算出IW4的值。您能帮助小王计算出IW4的值么？flag格式为:flag{}

附件下载：1-01.zip

<br/>

#### 损坏的风机

> 小明是一家新能源汽车制造厂的风机操作员，每天的工作是根据工厂的实时温度输入风机的转数，但由于机器的老化，风机最多能接受2000转/分钟的转速，在当天下班后，检修人员发现风机由于转速过快出现了故障，请根据维修人员捕获的流量包分析当天风机的转速达到了多少转才出现的故障，flag为发送高额转速的Data层的HEX数据。flag格式为:flag{}
>
> tips：Write Single Register

附件下载：1-02.zip

<br/>

#### 工控现场里异常的文件

> 小刘在一次对目标主机的渗透测试时发现了一个隐藏的exe格式文件，根据小刘多年的渗透经验，凭直觉断定此文件一定隐藏着一些不为人知的秘密，随后小刘迅速下载此文件，用各种工具和手段对其展开深度分析，你能帮他找出此exe中到底隐藏了些什么秘密吗？flag格式为:flag{}

附件下载：1-03.zip

<br/>

#### 隐藏的工程

> 老代凭借多年工业企业运维经验，发现ICS工程师的工作电脑中有一张可疑的工艺图。在对图片进行分析时,发现其中存在异常信息，您能从中找到flag吗？flag格式为:flag{}

附件下载：1-04.zip

<br/>

#### 异常的梯形图分析

> 某工厂的一个压力采集仪表中显示的数值与实际不符，工程师推测是程序出现错误，根据分析梯形图发现可能是其中一个变量的数值丢失导致计算程序出错，已知IW2值为5769，IW4为8956，V5为5768.658691，请帮工程师求出数值Q的值。flag格式为：flag{}

附件下载：1-05.zip

<br/>

#### OPC协议分析

> 某地区自动化网络安全专工对某工控企业进行渗透测试时，企业人员截获相关通信的数据包，请尝试对截获数据包解析并找出加密的关键信息。flag提交格式为:flag{}

附件下载：1-06.zip

<br/>

#### 工控安全异常取证分析

> 网络安全人员小吕在工厂中发现某台工程师站主机可能感染了病毒，小吕将磁盘导出后请你能帮忙一起分析出异常。flag格式为：flag{}

附件下载：1-07.zip

<br/>

#### 恶意文件分析

> 老付是一名运维工程师，在工作中遇到一个工控上位机中存在异常程序，你能帮助老付分析出异常文件么？flag格式为:flag{}

附件下载：1-08.zip

<br/>

#### Fins协议通讯

> 工程师小夏在工控日志流量审计设备中发现某台PLC设备通讯异常，请您帮助小夏分析出相关异常的加密数据。flag格式为：flag{}

附件下载：1-09.rar

<br/>

#### Modbus采集分析

> 安全巡检工程师会对控制设备运行情况进行检测分析，某日突然在流量中发现攻击者截取了工程师站采集数据的命令，并将采集命令进行了恶意篡改，导致上层无法获取设备正确的运行信息，影响企业正常生产运行，请分析出被篡改的恶意采集数据报文，获取flag。flag格式为：flag{}

附件下载：1-10.zip

<br/>

#### 工业变电控制系统远程测试

> 在保证PLC设备正常运行的前提下，攻击PLC设备，改变输电线工艺中端子配置，造成输电线熔断，并且保证其他工艺正常运行；并提交渗透测试报告。

<br/>

#### 工业采油控制系统远程测试

> 在保证PLC设备正常运行的前提下，攻击PLC设备，改变采油装置工艺流程，实现磕头机停止运行、P-139水泵停止运行、其他工艺正常运行；并提交渗透测试报告。

<br/>

#### 工业炼化控制系统远程测试

> 在保证PLC设备正常运行的前提下，攻击PLC设备，改变炼化装置工艺流程，实现所有电磁阀处于关闭状态，工艺停止运行；并提交渗透测试报告。

<br/>

#### 工业发电控制系统远程测试

> 在保证PLC设备正常运行的前提下，攻击PLC设备，修改发电工艺中的BV101电磁阀，造成水罐液位上升；并提交渗透测试报告。

<br/>

#### 工业智能制造控制系统远程测试

> 在保证PLC设备正常运行的前提下，攻击PLC设备，修改智能制造工艺流程，设置机械臂的启动点位置为关闭状态；并提交渗透测试报告。

<br/>

### 第二场

错过了，这比赛时间够可以的

<br/>

### 第三场

#### 异常的IEC104分析

> 小张在对电力企业进行渗透测试时，发现一台开启IEC104通讯协议的设备，并尝试对该设备进行测试。但是在IDS中发现了相关通讯异常。请尝试找出数据包中的flag。flag格式为:flag{}。

附件下载：3-01.zip

<br/>

#### 异常的s7comm

> 工程师小夏在针对西门子300PLC设备不定期的停止运行，发现设备存在异常外联控制，再对审计设备进行分析中发现数据包中存在异常的eth.trailer、eth.fcs,请您帮助小夏找到外联地址并发送异常的HEX，对服务器返回的HEX进行解密。flag格式为:flag{}。
>
> TIPS：向远程服务器发送hex内容,端口为37830

附件下载：3-02.zip

<br/>

#### 工控梯形图分析1

> 小张在进行设备调试时，编写了一段模拟量转换的程序，已知IW2的值为7750，V14为0.2396091521，请计算出V11的值帮助小张进一步分析，flag为V11与V13之和。flag格式为flag{}。
>
> TIPS：V9为30866

附件下载：3-03.zip

<br/>

#### 异常的协议分析

> 小代所在的企业车间PLC发生异常，造成生产线无法正常运行。请您帮助小代分析出PLC遭到异常的原因。flag格式为:flag{}。

附件下载：3-04.zip

<br/>

#### 工控指示灯的逻辑推理

> 小明刚刚入门工业自动化领域，某天发现一个很有意思的指示灯梯形图运行过程，你能帮助小明找出flag吗？（详细赛题实例请下载进行查看）,flag格式为flag{}。
>
> TIPS：灭：P，不是F

附件下载：3-05.zip

<br/>

#### 设备连接失败异常分析

> 小李所在的公司炼化车间遭受网络攻击，导致流水线控制器运行异常，经小李分析发现控制器与上位机无法链接，导致无法查看控制器内部的日志信息，请您帮助小李分析无法链接原因。flag格式为flag{}。

附件下载：3-06.zip

<br/>

#### 工控梯形图分析2

> 小王是工厂的一名工程师，每天的工作是启动设备进行加工，设备一共进行两次加工。设备在运转过程中突然停止工作，打开梯形图发现其中两个数值丢失，请帮助小王填补数值VD200与VD300，flag为VD200加上VD300。flag格式为flag{VD200_XX_VD300_XX}。

附件下载：3-07.zip

<br/>

#### 智能卡

> 小吕对一张已经过期的Mifare非接触智能卡进行修改，想进行延长智能卡的到期时间。小吕成功对数据解密并将数据dump出来，存为originalData。再将相关文件中的有关时间的数据进行修改并重新写入智能卡中。修改后本卡还是不能使用。小吕再次将卡内数据导出，存为modifyData。你能帮助小吕解决相关智能卡的使用吗？flag是文件的md5值。flag格式为:flag{}。

附件下载：3-08.zip

<br/>

#### 工控逆向分析

> 小刘在学习工控逆向分析的过程中遇到了一个难以调试GUI程序，你能帮助他调试吗？flag格式为:flag{}。

附件下载：3-09.zip

<br/>

#### 有趣的流水线2

> 小刘经过努力终于完成了罐装贴标签流水线运行。老师傅又给小刘一套自动模式程序，让小刘描述出其中的运行过程。你能帮助小刘吗？（详细赛题实例请下载进行查看）。flag为接触的字符前20位和后21位不包含"-"。flag格式为:flag{XX-XX-XX}。

附件下载：3-10.zip

<br/>

#### 工业变电控制系统远程测试3

> 通过修改PLC内部指令，使逆变器灯光由红色变为绿色，并提交渗透测试报告。

<br/>

#### 工业采油控制系统远程测试3

> 通过修改PLC内部寄存器地址攻击水泵P-130，将P-130水泵停止运行，使计量分离罐液位上升，并提交渗透测试报告。

<br/>

#### 工业炼化控制系统远程测试3

> 通过修改PLC内存寄存器地址，攻击P140输油泵，使原油储罐液位上升，并提交渗透测试报告。

<br/>

#### 工业发电控制系统远程测试3

> 通过修改PLC内部寄存器地址,攻击电磁阀装置，使电磁阀处于关闭状态，造成工艺瘫痪，并提交渗透测试报告。

<br/>

#### 工业智能制造控制系统远程测试3

> 通过修改PLC内部梯形图指令，使智能制造工艺流程瘫痪，工艺通过上位机启动失败，并提交渗透测试报告。