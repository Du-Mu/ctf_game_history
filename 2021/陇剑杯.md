## 比赛信息

> 比赛名称：首届“陇剑杯”网络安全大赛
>
> 比赛时间：2021年9月14日 10:00-18:00
>
> 比赛网址：https://ctf.ichunqiu.com/longjiancup

<br/>

## writeup

[第一届陇剑杯\_线上\_wp](https://mp.weixin.qq.com/s/Zeieu_IjymZgz8g2YckfWg)

<br/>

## 附件链接

链接：https://pan.baidu.com/s/1vAt6oBPpaNJY_AYPC7d13Q 提取码：xing

链接：https://pan.xunlei.com/s/VMjYrQjOoR-Bds42mUrJK6_JA1 提取码：xknn

链接：https://ctf.lanzoui.com/b02cfuumh 密码:xing

<br/>

## 题目信息

### 理论题

> 作答时间为10:00-10:20，超过时间将不允许提交。每个理论题目同一个队只能答一次。

#### 单选1(10p)

> 我们队伍已阅读并且透彻地理解了比赛的有关规定和纪律要求，自觉遵守比赛纪律，诚实守信，不违规，不作弊，如有违反，自愿按规定接受处理。我们队伍报名时所提供的个人信息是真实、准确、完整的，如因个人信息错误、失真、缺失造成不良后果，责任由队员承担。
>
> 接受
>
> 不接受

<br/>

#### 单选2(10p)

> 《中华人民共和国数据安全法》自（ ）起开始施行？
>
> 2018/9/7
>
> 2020/6/28
>
> 2021/6/10
>
> 2021/9/1

<br/>

#### 单选3(10p)

> 下列选项中不属于《中华人民共和国数据安全法》中关于建立数据安全制度相关举措的是（ ）？
>
> 国家建立数据传播安全制度
>
> 国家建立数据分类分级保护制度
>
> 国家建立集中统一、高效权威的数据安全风险评估、报告、信息共享、监测预警机制
>
> 国家建立数据安全应急处置机制

<br/>

#### 单选4(10p)

> 下列关于防火墙说法错误的描述错误的是（ ）？
>
> 防火墙的主要类型有过滤型防火墙、应用代理类型防火墙以及复合型
>
> 防火墙中涉及的关键技术有包过滤技术、加密技术、防病毒技术、代理服务器等
>
> 防火墙可以阻止内部主动发起连接的攻击
>
> 应用在外网中的防火墙，可以使得内网对于外网而言处于完全封闭状态，外网无法解析内网的任何信息

<br/>

#### 单选5(10p)

> 下列关于常见服务对应的默认端口及其传输层协议说法错误的是（ ）？
>
> HTTP：80/TCP
>
> FTP：21/TCP
>
> Telnet：23/UDP
>
> DNS：53/UDP

<br/>

#### 单选6(10p)

> 根据《中华人民共和国数据安全法》规定，从事数据交易中介服务的机构在提供服务时，可以不审核交易双方的身份，但应要求数据提供方说明数据来源，并留存交易记录。这个描述是（ ）。
>
> 对的
>
> 错的

<br/>

#### 单选7(10p)

> 根据《中华人民共和国数据安全法》规定，国家安全机关可以根据维护国家安全或者侦查犯罪的需要依法调取数据，但需要经过严格的批准手续。这个描述是（ ）。
>
> 对的
>
> 错的

<br/>

#### 单选8(10p)

> 根据《中华人民共和国数据安全法》规定，公安机关以及国家安全机关负责统筹协调网络数据安全和相关监管工作。这个描述是（ ）。
>
> 对的
>
> 错的

<br/>

#### 单选9(10p)

> 下列不是《网络安全法》的基本原则的是（ ）。
>
> 网络空间主权原则
>
> 共同治理原则
>
> 网络安全与信息化发展并重原则
>
> 网络安全监管体制法制化原则

<br/>

#### 单选10(10p)

> 零信任安全架构最早由约翰·金德维格在2010年提出，如今零信任安全架构已经逐步被业界所认可，特别是2017年Google基于零信任安全架构构建的BeyondCorp项目成功完成，为零信任安全架构提供了可靠的实践背书。下列关于零信任安全架构说法错误的是（ ）。
>
> 传统的基于边界的网络安全架构在某种程度上假设或默认了内网是安全的，认为安全就是构筑企业的数字护城河，通过防火墙、WAF、IPS等边界安全产品或方案对企业网络出口进行重重防护，却忽略了企业内网的安全。
>
> 零信任安全架构理念可简单概括为：应该始终假设网络充满威胁；外部和内部威胁每时每刻都充斥着网络；不能仅仅依靠网络位置来建立信任关系；所有设备、用户和网络流量都应该被认证和授权；访问控制策略应该动态地、基于尽量多的数据源进行计算和评估。
>
> 零信任安全架构从本质上可以概括为以身份为中心进行动态访问控制，是在不可信的现代网络环境下，以身份为中心，通过动态访问控制技术，以细粒度的应用、接口、数据为核心保护对象，遵循最小权限原则，构筑端到端的逻辑身份边界。
>
> 零信任安全架构采用了强度较高的多因子认证，可以认为进行了身份认证后可以确保身份的持续合法性。

<br/>

#### 多选1(20p)

> 根据《中华人民共和国数据安全法》规定，下列属于中央国家安全领导机构的工作范围的有（ ）？
>
> 负责统筹协调网络数据安全和相关监管工作
>
> 国家数据安全工作的决策和议事协调
>
> 统筹协调国家数据安全的重大事项和重要工作
>
> 指导实施国家数据安全战略和有关重大方针政策

<br/>

#### 多选2(20p)

> 下列选项中与《中华人民共和国数据安全法》的制定目标相符的有（ ）?
>
> 保障数据安全
>
> 促进数据开发利用
>
> 维护国家主权
>
> 规范数据处理

<br/>

#### 多选3(20p)

> 下列选项中属于《中华人民共和国数据安全法》中促进数据安全与发展的举措有（ ）？
>
> 支持数据开发利用和数据安全技术研究
>
> 建立健全数据交易管理制度
>
> 建立健全数据共享机制
>
> 支持教育、科研机构和企业等开展数据开发利用技术和数据安全相关教育和培训

<br/>

#### 多选4(20p)

> 在Windows系统中下列哪些日志可以利用命令行工具eventcreate来伪造。（ ）
>
> 系统日志
>
> 安全日志
>
> 应用日志

<br/>

#### 多选5(20p)

> 以下哪些模式属于防火墙的部署方式。（ ）
>
> 路由模式
>
> 混合模式
>
> 交换模式
>
> 透明模式

<br/>

#### 多选6(20p)

> 以下哪些属于VPN常见的实现方式？（ ）
>
> VPN服务器
>
> 软件VPN
>
> 硬件VPN
>
> 集成VPN

<br/>

#### 多选7(20p)

> 下列关于扫描器说法正确的有？（ ）
>
> 具有发现一个主机或网络的能力
>
> 具有直接攻击网络漏洞的能力
>
> 发现一台主机后，有发现什么服务正运行在这台主机上的能力
>
> 通过测试服务，具有发现漏洞的能力

<br/>

#### 多选8(20p)

> 网络运营者应当按照网络安全等级保护制度的要求，履行下列哪些安全保护义务？（ ）
>
> 保障网络免受干扰、破坏或者未经授权的访问
>
> 防止网络数据泄露或者被窃取、篡改
>
> 不得设置恶意程序
>
> 制定网络安全事件应急预案

<br/>

#### 多选9(20p)

> 网络安全的级别包括（ ）。
>
> 系统安全
>
> 网站的安全
>
> 信息传播安全
>
> 信息内容安全

<br/>

#### 多选10(20p)

> 信息安全等级保护原则为（ ）。
>
> 自主保护原则
>
> 重点保护原则
>
> 同步建设原则
>
> 动态调整原则

<br/>

### 签到

> 网管小王在上网途中发现自己的网络访问异常缓慢，于是对网络出口捕获了流量，请您分析流量后进行回答：（本题仅1小问）

附件下载：签到.zip

#### 1.1(50p)

> 此时正在进行的可能是__________协议的网络攻击。（如有字母请全部使用小写，填写样例：http、dns、ftp）

<br/>

### jwt

> 昨天，单位流量系统捕获了黑客攻击流量，请您分析流量后进行回答：

附件下载：jwt.zip

<br/>

#### 2.1(50p)

> 该网站使用了______认证方式。（如有字母请全部使用小写）

<br/>

#### 2.2(50p)

> 黑客绕过验证使用的jwt中，id和username是______。（中间使用#号隔开，例如1#admin）

<br/>

#### 2.3(50p)

> 黑客获取webshell之后，权限是______？

<br/>

#### 2.4(100p)

> 黑客上传的恶意文件文件名是_____________。(请提交带有文件后缀的文件名，例如x.txt)

<br/>

#### 2.5(50p)

> 黑客在服务器上编译的恶意so文件，文件名是_____________。(请提交带有文件后缀的文件名，例如x.so)

<br/>

#### 2.6(100p)

> 黑客在服务器上修改了一个配置文件，文件的绝对路径为_____________。（请确认绝对路径后再提交）

<br/>

### webshell

> 单位网站被黑客挂马，请您从流量中分析出webshell，进行回答：

附件下载：webshell.zip

<br/>

#### 3.1(50p)

> 黑客登录系统使用的密码是_____________。

<br/>

#### 3.2(100p)

> 黑客修改了一个日志文件，文件的绝对路径为_____________。（请确认绝对路径后再提交）

<br/>

#### 3.3(50p)

> 黑客获取webshell之后，权限是______？

<br/>

#### 3.4(50p)

> 黑客写入的webshell文件名是_____________。(请提交带有文件后缀的文件名，例如x.txt)

<br/>

#### 3.5(100p)

> 黑客上传的代理工具客户端名字是_____________。（如有字母请全部使用小写）

<br/>

#### 3.6(100p)

> 黑客代理工具的回连服务端IP是_____________。

<br/>

#### 3.7(50p)

> 黑客的socks5的连接账号、密码是______。（中间使用#号隔开，例如admin#passwd）

<br/>

### 日志分析

> 单位某应用程序被攻击，请分析日志，进行作答：

附件下载：日志分析.zip

<br/>

#### 4.1(50p)

> 网络存在源码泄漏，源码文件名是_____________。(请提交带有文件后缀的文件名，例如x.txt)

<br/>

#### 4.2(50p)

> 分析攻击流量，黑客往/tmp目录写入一个文件，文件名为_____________。

<br/>

#### 4.3(100p)

> 分析攻击流量，黑客使用的是______类读取了秘密文件。

<br/>

### 流量分析

> 某天晚上，X单位的网站被黑客入侵了，管理员从单位网络出口捕获采样流量，请您分析流量进行回答：

附件下载：流量分析.zip

<br/>

#### 5.1(150p)

> 攻击者的IP是_____________。

<br/>

#### 5.2(100p)

> 攻击者所使用的会话密钥是_____________。

<br/>

#### 5.3(50p)

> 攻击者所控制的C&C服务器IP是_____________。

<br/>

### 内存分析

> 网管小王制作了一个虚拟机文件，让您来分析后作答：

附件下载：内存分析.7z（239.6M）

<br/>

#### 6.1(200p)

> 虚拟机的密码是_____________。（密码中为flag{xxxx}，含有空格，提交时不要去掉）

<br/>

#### 6.2(200p)

> 虚拟机中有一个某品牌手机的备份文件，文件里的图片里的字符串为_____________。（解题过程中需要用到上一题答案中flag{}内的内容进行处理。本题的格式也是flag{xxx}，含有空格，提交时不要去掉）

<br/>

### 简单日志分析

> 某应用程序被攻击，请分析日志后作答：

附件下载：简单日志分析.zip

<br/>

#### 7.1(50p)

> 黑客攻击的参数是______。（如有字母请全部使用小写）

<br/>

#### 7.2(50p)

> 黑客查看的秘密文件的绝对路径是_____________。

<br/>

#### 7.3(50p)

> 黑客反弹shell的ip和端口是_____________。（格式使用“ip:端口"，例如127.0.0.1:2333）

<br/>

### SQL注入

> 某应用程序被攻击，请分析日志后作答：

附件下载：SQL注入.zip

<br/>

#### 8.1(50p)

> 黑客在注入过程中采用的注入手法叫_____________。（格式为4个汉字，例如“拼搏努力”）

<br/>

#### 8.2(100p)

> 黑客在注入过程中，最终获取flag的数据库名、表名和字段名是_____________。（格式为“数据库名#表名#字段名”，例如database#table#column）

<br/>

#### 8.3(150p)

> 黑客最后获取到的flag字符串为_____________。

<br/>

### wifi

> 网管小王最近喜欢上了ctf网络安全竞赛，他使用“哥斯拉”木马来玩玩upload-labs，并且保存了内存镜像、wifi流量和服务器流量，让您来分析后作答：（本题仅1小问）

附件下载：wifi.zip（272.3M）

<br/>

#### 9.1(300p)

> 小王往upload-labs上传木马后进行了cat /flag，flag内容为_____________。（压缩包里有解压密码的提示，需要额外添加花括号）

<br/>

### ios

> 一位ios的安全研究员在家中使用手机联网被黑，不仅被窃密还丢失比特币若干，请你通过流量和日志分析后作答：

附件下载：ios.zip

<br/>

#### 10.1(50p)

> 黑客所控制的C&C服务器IP是_____________。

<br/>

#### 10.2(50p)

> 黑客利用的Github开源项目的名字是______。（如有字母请全部使用小写）

<br/>

#### 10.3(50p)

> 通讯加密密钥的明文是____________。

<br/>

#### 10.4(150p)

> 黑客通过SQL盲注拿到了一个敏感数据，内容是____________。

<br/>

#### 10.5(100p)

> 黑客端口扫描的扫描器的扫描范围是____________。（格式使用“开始端口-结束端口”，例如1-65535）

<br/>

#### 10.6(200p)

> 被害者手机上被拿走了的私钥文件内容是____________。

<br/>

#### 10.7(150p)

> 黑客访问/攻击了内网的几个服务器，IP地址为____________。（多个IP之间按从小到大排序，使用#来分隔，例如127.0.0.1#192.168.0.1)

<br/>

#### 10.8(50p)

> 黑客写入了一个webshell，其密码为____________。

<br/>

### 机密内存

> 一日网管中心的安全审计设备推送了一则高危入侵警报，经过了解发现有一台机密容器因违规操作遭遇入侵与破坏，容器宿主机内只留下了一段机密容器的内存与部分经过篡改的神秘文件，请你帮助还原容器的入侵过程。
>
> （下载链接在比赛公告里，该大文件的解压密码为cf15e15d7054da59fb20e99d943294a7）

附件下载：

<br/>

#### 11.1(200p)

> 取证人员首先对容器的基本信息进行核实，经过确定该容器的基本信息为________。（答案为32位小写md5(容器操作系统系统的版本号+容器主机名+系统用户名），例如：操作系统的版本号为10.0.22449，容器主机名为DESKTOP-0521,系统登录用户名为admin，则该题答案为32位小写md5(10.0.22449DESKTOP-0521admin) 的值ae278d9bc4aa5ee84a4aed858d17d52a)

<br/>

#### 11.2(200p)

> 黑客入侵容器后曾通过木马控制端使用Messagebox发送过一段信息，该信息的内容是____________。（答案为Messagebox信息框内内容）

<br/>

#### 11.3(200p)

> 经过入侵分析发现该容器受到入侵的原因为容器使用人的违规进行游戏的行为，该使用人进行游戏程序的信息是__________。（答案为“32位小写md5(游戏程序注册邮箱+游戏程序登录用户名+游戏程序登录密码)，例如：注册邮箱为adol@163.com,登录用户名为user,密码为user1234，则该题答案为” adol@163.comuseruser1234”的小写md5值5f4505b7734467bfed3b16d5d6e75c16)

<br/>

#### 11.4(200p)

> 经过入侵分析发现该容器曾被黑客植入木马控制的信息是_________。（答案为“32位小写md5(木马程序进程名+木马回连ip地址+木马回连ip端口）”，例如：木马程序进程名为svhost.exe，木马回连ip为1.1.1.1，木马回连端口为1234，则该题答案为“svhost.exe1.1.1.11234”的32位小写md5值f02da74a0d78a13e7944277c3531bbea)

<br/>

#### 11.5(200p)

> 经过入侵分析，发现黑客曾经运行过痕迹清除工具，该工具运行的基本信息是________。（答案为“32为小写md5”(痕迹清除工具执行程序名+最后一次运行时间)，例如：黑客运行工具执行程序名为run.exe，运行时间为2021-07-10 10:10:13，则本题的答案为小写的32位md5(run.exe2021-07-10 10:10:13) 值为82d7aa7a3f1467b973505702beb35769，注意：本题中运行时间的格式为yy-mm-dd hh:mm:ss，时间时区为UTC+8）